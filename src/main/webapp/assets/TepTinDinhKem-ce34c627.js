import{e as te,A as p,h as ne,B as ie,M as P,o as se,i as s,F as T,d as o,w as l,I,H as j,l as ue,j as r,k as u,G as g,v as c,E as b,t as d,q as _,s as z,O as v,N as ce,K as de,L as re}from"./index-7ff11648.js";import{$ as N}from"./jquery-da988d60.js";import{u as pe}from"./hosodvc-cec002e8.js";import{t as M}from"./toastr-b359f669.js";import{_ as he}from"./_plugin-vue_export-helper-c27b6911.js";import{V as U,a as O}from"./VRow-51978c15.js";import{V}from"./VTooltip-98f2d52f.js";import{V as F,a as R,b as fe}from"./VCard-00827b24.js";import{V as X,a as q,b as Q,c as W}from"./VToolbarItems-fee21185.js";import{V as Te}from"./VForm-19110563.js";const h=C=>(de("data-v-ec85daa3"),C=C(),re(),C),_e={style:{"font-weight":"600",width:"100%"}},ye={key:0,style:{color:"red"}},De=["onClick"],ge={class:"ml-2",style:{"font-size":"14px","text-decoration":"underline",color:"#1E7D30"}},me=h(()=>u("span",null,"Tải xuống",-1)),ve=h(()=>u("span",null,"Xóa",-1)),xe={key:1,style:{width:"100%"}},ke={style:{width:"100%"},class:"pl-3"},we=h(()=>u("span",null,"- ",-1)),be=["onClick"],Ce={class:"ml-2",style:{"font-size":"14px","text-decoration":"underline",color:"#1E7D30"}},Le=h(()=>u("span",null,"Tải xuống",-1)),Se=h(()=>u("span",null,"Xóa",-1)),Ge={style:{width:"100%"}},ze=h(()=>u("span",{style:{"font-size":"14px","text-transform":"none"}},"Tải lên tệp",-1)),Me=h(()=>u("div",{class:"sub-header-content"}," Tên giấy tờ ",-1)),Ve=h(()=>u("div",{class:"triangle-header"},null,-1)),He=h(()=>u("div",{class:"sub-header-content"}," Tệp tin đính kèm ",-1)),Ae=h(()=>u("div",{class:"triangle-header"},null,-1)),Ie=["src"],Fe={__name:"TepTinDinhKem",props:{permission:{type:Boolean,default:!1}},setup(C){M.options={closeButton:!0,timeOut:"5000",positionClass:"toast-top-center"},te();const x=p("#1E7D30"),y=ne(),H=pe();p(!1);const k=p(!1),L=p(!1),K=p(""),S=p(""),E=p(null),m=p(!1),B=ie(function(){let n=y.thongTinHoSo.ThanhPhanHoSo.filter(function(a){return!a.MaThanhPhanHoSo||a.MaThanhPhanHoSo&&a.MaThanhPhanHoSo.MaMuc.split("_")[0]!=="BMDT"});return n.forEach((a,e)=>{a.HinhThucGiayTo.MaMuc=="true"&&(n[e].items=n.filter(function(i){let t=i.IDGiayTo.split("-");return t[0]=="GTK"&&t[1]==a.IDGiayTo}))}),n.filter(function(a){return String(a.IDGiayTo).split("-")[0]!=="GTK"})}),A=p(null),$=p(null);P([{sortable:!1,title:"Tên giấy tờ",align:"left",key:"tenGiayTo",class:"td-left"},{sortable:!1,title:"Tệp đính kèm",align:"left",key:"tepDinhKem",class:"td-left"}]),P([{sortable:!1,title:"TT",align:"center",key:"index",class:"td-left"},{sortable:!1,title:"Tên giấy tờ",align:"left",key:"tepDinhKem",class:"td-left"}]);const J=function(n,a){A.value=n,$.value=a,document.getElementById("file_upload_tep_dinh_kem").value="",document.getElementById("file_upload_tep_dinh_kem").click()},Y=function(n){console.log("fileUpload",n);let a=n.name?n.name.split("."):"",e=a?a[a.length-1]:"",i=["png","jpg","jpeg","pdf","docx","doc","xls","xlsx","txt","rtf"],t=10;try{t=fileSizeAllowConfig||10}catch{}try{i=fileTypeAllowConfig||["png","jpg","jpeg","pdf","docx","doc","xls","xlsx","txt","rtf"]}catch{}let D=i?i.filter(function(w){return w===String(e).toLocaleLowerCase()}):"",f=!1;return D&&D.length>0?Number(n.size)<=t*1048576?f=!0:(M.error("Tài liệu tải lên dung lượng tối đa là "+t+" MB"),f=!1):(M.error("Tài liệu tải lên chỉ chấp nhận các định dạng "+i.toString()),f=!1),f},Z=function(){let n=N("#file_upload_tep_dinh_kem")[0].files[0];Y(n)&&(A.value.HinhThucGiayTo.MaMuc=="false"?H.uploadTep(n).then(function(e){y.$patch(i=>{i.thongTinHoSo.ThanhPhanHoSo[$.value+1].TepDuLieu=e.resp})}).catch(function(e){}):le())},G=function(n,a){m.value||(m.value=!0,H.taiTep(n).then(function(e){if(m.value=!1,a=="preview")K.value=e,L.value=!0;else{var i=document.createElement("a");document.body.appendChild(i),i.style="display: none",i.href=e,i.download=n.TenTep,i.click()}}).catch(function(e){m.value=!1}))},ee=function(n,a){y.$patch(e=>{e.thongTinHoSo.ThanhPhanHoSo[a+1].TepDuLieu={DinhDangTep:"",DuongDanURL:"",Ext:"unknown",KichThuocTep:0,MaDinhDanh:"",TenTep:""}})},le=function(){S.value="",k.value=!0},oe=function(n,a){y.SET_SHOWCONFIRM(!0);let e={auth:!1,title:"Xóa giấy tờ",message:"Bạn có chắc chắn muốn xóa giấy tờ này",button:{yes:"Có",no:"Không"},callback:()=>{y.$patch(i=>{i.thongTinHoSo.ThanhPhanHoSo[a+1].items.splice(n,1)})}};y.SET_CONFIG_CONFIRM_DIALOG(e)},ae=async function(){const{valid:n}=await E.value.validate();if(n){let a=N("#file_upload_tep_dinh_kem")[0].files[0];H.uploadTep(a).then(function(e){k.value=!1;let i={IDGiayTo:"GTK-"+A.value.IDGiayTo,TenGiayTo:S.value,SoBanGiay:0,HinhThucGiayTo:{MaMuc:"",TenMuc:""},NgayBoSung:null,MaThanhPhanHoSo:null,MaGiayToKetQua:null,DaHuyBoThayThe:!1,TinhTrangSoHoa:1,GiayToCaNhanToChuc:{MaDinhDanh:"",TenGiayTo:""},TepDuLieu:e.resp,GiayToLuuTruSo:{MaDinhDanh:"",TenGiayTo:""},DuLieuDienTu:{MaDinhDanh:""}};y.$patch(t=>{t.thongTinHoSo.ThanhPhanHoSo.push(i)}),console.log("tphsAddthanhPhanHoSo",B.value)}).catch(function(e){M.error("Tải lên giấy tờ thất bại")})}};return se(()=>{}),(n,a)=>(s(),T(I,null,[o(F,{class:"pa-0 thanhphanhoso",style:{"box-shadow":"none !important",width:"100%"}},{default:l(()=>[o(U,{class:"mx-0 my-0",style:{"border-top":"1px dotted #DADADA","border-left":"1px dotted #DADADA"}},{default:l(()=>[(s(!0),T(I,null,j(ue(B),(e,i)=>(s(),r(U,{key:e.IDGiayTo,class:"mx-0 my-0 px-2 py-2",style:{width:"100%","border-bottom":"1px dotted #DADADA","border-right":"1px dotted #DADADA","align-items":"center","min-height":"42px"}},{default:l(()=>[u("div",_e,[u("span",null,g(i+1)+". ",1),u("span",null,g(e.TenGiayTo),1),c(),e.HinhThucGiayTo.TenMuc=="true"?(s(),T("span",ye,"(*)")):b("",!0)]),e.TepDuLieu.KichThuocTep?(s(),T("div",{key:0,class:"py-1",onClick:t=>G(e.TepDuLieu,"preview"),style:{width:"100%"}},[e.TepDuLieu.DinhDangTep==="xls"||e.TepDuLieu.DinhDangTep==="xlsx"?(s(),r(d,{key:0,size:"18",color:"green"},{default:l(()=>[c("mdi-file-excel-outline")]),_:1})):e.TepDuLieu.DinhDangTep==="doc"||e.TepDuLieu.DinhDangTep==="docx"?(s(),r(d,{key:1,size:"18",color:"blue"},{default:l(()=>[c("mdi-file-word-outline")]),_:1})):e.TepDuLieu.DinhDangTep==="pdf"?(s(),r(d,{key:2,size:"18",color:"red"},{default:l(()=>[c("mdi-file-pdf-box")]),_:1})):e.TepDuLieu.DinhDangTep==="png"||e.TepDuLieu.DinhDangTep==="jpg"||e.TepDuLieu.DinhDangTep==="jpeg"?(s(),r(d,{key:3,size:"18",color:"blue"},{default:l(()=>[c("mdi-file-image")]),_:1})):(s(),r(d,{key:4,size:"18",color:"#2161b1"},{default:l(()=>[c("mdi-paperclip")]),_:1})),u("a",ge,g(e.TepDuLieu.TenTep)+"."+g(e.TepDuLieu.Ext),1),o(V,{location:"top"},{activator:l(({props:t})=>[o(_,z({icon:"",variant:"flat",size:"small"},t,{class:"mr-0",onClick:v(D=>G(e.TepDuLieu,"download"),["stop"])}),{default:l(()=>[o(d,{size:"18",color:x.value},{default:l(()=>[c("mdi-cloud-download-outline")]),_:1},8,["color"])]),_:2},1040,["onClick"])]),default:l(()=>[me]),_:2},1024),o(V,{location:"top"},{activator:l(({props:t})=>[o(_,z({icon:"",variant:"flat",size:"small"},t,{class:"mr-2",onClick:v(D=>ee(e,i),["stop"])}),{default:l(()=>[o(d,{size:"18",color:"red"},{default:l(()=>[c("mdi-close")]),_:1})]),_:2},1040,["onClick"])]),default:l(()=>[ve]),_:2},1024)],8,De)):b("",!0),e.HinhThucGiayTo.MaMuc=="true"?(s(),T("div",xe,[(s(!0),T(I,null,j(e.items,(t,D)=>(s(),T("div",{key:D},[u("div",ke,[we,u("span",null,g(t.TenGiayTo)+": ",1),t.TepDuLieu.KichThuocTep?(s(),T("span",{key:0,class:"py-1",onClick:f=>G(t.TepDuLieu,"preview")},[t.TepDuLieu.DinhDangTep==="xls"||t.TepDuLieu.DinhDangTep==="xlsx"?(s(),r(d,{key:0,size:"18",color:"green"},{default:l(()=>[c("mdi-file-excel-outline")]),_:1})):t.TepDuLieu.DinhDangTep==="doc"||t.TepDuLieu.DinhDangTep==="docx"?(s(),r(d,{key:1,size:"18",color:"blue"},{default:l(()=>[c("mdi-file-word-outline")]),_:1})):t.TepDuLieu.DinhDangTep==="pdf"?(s(),r(d,{key:2,size:"18",color:"red"},{default:l(()=>[c("mdi-file-pdf-box")]),_:1})):t.TepDuLieu.DinhDangTep==="png"||t.TepDuLieu.DinhDangTep==="jpg"||t.TepDuLieu.DinhDangTep==="jpeg"?(s(),r(d,{key:3,size:"18",color:"blue"},{default:l(()=>[c("mdi-file-image")]),_:1})):(s(),r(d,{key:4,size:"18",color:"#2161b1"},{default:l(()=>[c("mdi-paperclip")]),_:1})),u("a",Ce,g(t.TepDuLieu.TenTep)+"."+g(t.TepDuLieu.Ext),1),o(V,{location:"top"},{activator:l(({props:f})=>[o(_,z({icon:"",variant:"flat",size:"small"},f,{class:"mr-0",onClick:v(w=>G(t.TepDuLieu,"download"),["stop"])}),{default:l(()=>[o(d,{size:"18",color:x.value},{default:l(()=>[c("mdi-cloud-download-outline")]),_:1},8,["color"])]),_:2},1040,["onClick"])]),default:l(()=>[Le]),_:2},1024),o(V,{location:"top"},{activator:l(({props:f})=>[o(_,z({icon:"",variant:"flat",size:"small"},f,{class:"mr-2",onClick:v(w=>oe(D,i),["stop"])}),{default:l(()=>[o(d,{size:"18",color:"red"},{default:l(()=>[c("mdi-close")]),_:1})]),_:2},1040,["onClick"])]),default:l(()=>[Se]),_:2},1024)],8,be)):b("",!0)])]))),128))])):b("",!0),u("div",Ge,[e.HinhThucGiayTo.MaMuc=="true"||e.HinhThucGiayTo.MaMuc=="false"&&!e.TepDuLieu.KichThuocTep?(s(),r(_,{key:0,class:"mx-0 ml-2 mt-2",size:"small",variant:"outlined",color:"#1E7D30",onClick:v(t=>J(e,i),["stop"]),height:"28px",width:"120px"},{default:l(()=>[o(d,{size:"22",color:"#1E7D30",class:"mr-2"},{default:l(()=>[c("mdi-cloud-upload-outline")]),_:1}),ze]),_:2},1032,["onClick"])):b("",!0)])]),_:2},1024))),128))]),_:1}),u("input",{type:"file",id:"file_upload_tep_dinh_kem",multiple:!1,onInput:a[0]||(a[0]=e=>Z()),style:{display:"none"}},null,32)]),_:1}),o(W,{"max-width":"900",modelValue:k.value,"onUpdate:modelValue":a[3]||(a[3]=e=>k.value=e),persistent:""},{default:l(()=>[o(F,null,{default:l(()=>[o(X,{dark:"",color:x.value,class:"px-0"},{default:l(()=>[o(O,{class:"sub-header d-flex align-center justify-start py-0 px-0"},{default:l(()=>[Me,Ve]),_:1}),o(q),o(Q,null,{default:l(()=>[o(_,{variant:"flat",size:"small",icon:"",color:"#E9FFF2",onClick:a[1]||(a[1]=e=>k.value=!1)},{default:l(()=>[o(d,{size:"20"},{default:l(()=>[c("mdi-close")]),_:1})]),_:1})]),_:1})]),_:1},8,["color"]),o(R,{class:"mt-2 px-3"},{default:l(()=>[o(Te,{ref_key:"formGiayToKhac",ref:E,"lazy-validation":"",class:"py-0"},{default:l(()=>[o(ce,{modelValue:S.value,"onUpdate:modelValue":a[2]||(a[2]=e=>S.value=e),placeholder:"Nhập tên giấy tờ",dense:"","hide-details":"auto",class:"input-form",clearable:"",required:"",rules:[e=>e!==""&&e!==null&&e!==void 0||"Thông tin bắt buộc"]},null,8,["modelValue","rules"])]),_:1},512)]),_:1}),o(fe,{class:"justify-center pb-3 px-3"},{default:l(()=>[o(_,{size:"small",variant:"elevated",loading:m.value,disabled:m.value,color:x.value,"prepend-icon":"mdi-content-save",onClick:v(ae,["stop"])},{default:l(()=>[c(" Đồng ý ")]),_:1},8,["loading","disabled","color","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(W,{"max-width":"1000",modelValue:L.value,"onUpdate:modelValue":a[5]||(a[5]=e=>L.value=e),persistent:""},{default:l(()=>[o(F,null,{default:l(()=>[o(X,{dark:"",color:x.value,class:"px-0"},{default:l(()=>[o(O,{class:"sub-header d-flex align-center justify-start py-0 px-0"},{default:l(()=>[He,Ae]),_:1}),o(q),o(Q,null,{default:l(()=>[o(_,{variant:"flat",size:"small",icon:"",color:"#E9FFF2",onClick:a[4]||(a[4]=e=>L.value=!1)},{default:l(()=>[o(d,{size:"20"},{default:l(()=>[c("mdi-close")]),_:1})]),_:1})]),_:1})]),_:1},8,["color"]),o(R,{class:"my-0 px-0 py-0"},{default:l(()=>[u("iframe",{src:K.value,type:"application/pdf",width:"100%",height:"100%",style:{overflow:"auto","min-height":"600px"},frameborder:"0"},`\r
        `,8,Ie)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},Xe=he(Fe,[["__scopeId","data-v-ec85daa3"]]);export{Xe as default};
