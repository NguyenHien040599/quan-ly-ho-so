import{p as E,m as B,a as F,g as G,P as K,c as O,d as e,x as U,h as H,y as q,A as i,o as M,i as x,G as k,w as a,k as o,Q as A,v as g,N,R,q as V,t as b,D as z,S as D,T as L}from"./index-fe848f2d.js";import{t as c}from"./toastr-b359f669.js";import{a as J}from"./authorization-577193f6.js";import{V as p,a as m}from"./VRow-09778906.js";import{V as Q}from"./VForm-169f16b1.js";import"./jquery-da988d60.js";const W=E({fluid:{type:Boolean,default:!1},...B(),...F()},"VContainer"),Z=G()({name:"VContainer",props:W(),setup(r,v){let{slots:u}=v;const{rtlClasses:h}=K();return O(()=>e(r.tag,{class:["v-container",{"v-container--fluid":r.fluid},h.value,r.class],style:r.style},u)),{}}});const X={class:"wrap-login"},Y={class:"container-wrap"},j={key:0,class:"wrap-form px-4 py-3"},$=o("div",{style:{color:"white"},class:"mb-2"},"Tên đăng nhập",-1),ee=o("div",{style:{color:"white"},class:"mb-2"},"Mật khẩu",-1),te={key:1,class:"wrap-form px-3 py-3"},ae=o("div",{class:"text-login"},"TÀI KHOẢN ĐÃ ĐĂNG NHẬP HỆ THỐNG",-1),se=o("span",null,"Truy cập hệ thống",-1),ne={class:"v-btn__content"},oe=o("span",null,"Đăng xuất",-1),le={class:"text-center"},me={__name:"Login",setup(r){c.options={closeButton:!0,timeOut:"5000",positionClass:"toast-top-center"};const v=U(),u=H(),h=J(),{cookies:l}=q(),P=i(!1),n=i(!1),T=i(!0),f=i("1301032725"),_=i("1301032725"),d=i(!1),y=function(){if(n.value||!f.value||!_.value)return;n.value=!0;let S={data:{username:f.value,password:_.value,grant_type:"password",client_id:"bvdlcn-client",client_secret:"NgWhFZ8qHsEWz9587n1FOiRPUg3YQC2u3KSf9PZaTAsMvqVXDMl0RGFShhmbnb6C"}};h.login(S).then(function(t){if(n.value=!1,t&&t.access_token){let s=String(t.access_token.split(".")[1]).replace(/_/g,"/"),C=JSON.parse(atob(s));l.set("Token",t.access_token,t.expires_in),l.set("RefreshToken",t.refresh_token,t.refresh_expires_in),l.set("UserInfo",JSON.stringify(C),t.expires_in),L.defaults.headers.Authorization="Bearer "+t.access_token,u.SET_ISSIGNED(!0),u.SET_USERINFO(C),w()}else c.remove(),c.error("Tên đăng nhập hoặc mật khẩu không chính xác")}).catch(function(t){n.value=!1,c.remove(),c.error("Tên đăng nhập hoặc mật khẩu không chính xác")})},I=function(){d.value=!1,u.SET_ISSIGNED(!1),localStorage.setItem("user",null),l.set("Token",""),l.set("RefreshToken","")},w=function(){v.push({path:"/"})};return M(()=>{l.get("Token")?d.value=!0:d.value=!1}),(S,t)=>(x(),k("div",X,[e(Z,{id:"login-page",class:"px-0 pt-0",fluid:"",tag:"section"},{default:a(()=>[o("div",Y,[d.value?z("",!0):(x(),k("div",j,[o("div",null,[e(Q,{ref:"form",modelValue:T.value,"onUpdate:modelValue":t[2]||(t[2]=s=>T.value=s),"lazy-validation":"",class:""},{default:a(()=>[e(p,{class:"action-title my-0 mb-2",align:"center",style:{"text-align":"center","font-size":"22px","font-family":"'Roboto Slab'",color:"#fff","font-weight":"700"}},{default:a(()=>[e(m,{class:"py-0"},{default:a(()=>[g("ĐĂNG NHẬP")]),_:1})]),_:1}),e(p,{class:"my-0"},{default:a(()=>[e(m,{class:"py-0"},{default:a(()=>[$,e(N,{dense:"",class:"input-text",modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=s=>f.value=s),rules:[s=>!!s||"Tên đăng nhập là bắt buộc"],required:"","prepend-inner-icon":"mdi:mdi-account",onKeyup:R(y,["enter"]),"hide-details":"auto"},null,8,["modelValue","rules","onKeyup"])]),_:1})]),_:1}),e(p,{xs12:"",class:"mb-0"},{default:a(()=>[e(m,{class:"py-0"},{default:a(()=>[ee,e(N,{class:"input-text",dense:"",modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=s=>_.value=s),type:"password",rules:[s=>!!s||"Mật khẩu là bắt buộc"],required:"","prepend-inner-icon":"mdi:mdi-key",onKeyup:R(y,["enter"]),"hide-details":"auto"},null,8,["modelValue","rules","onKeyup"])]),_:1})]),_:1}),e(p,{align:"center",class:"wrap-btn-login my-3"},{default:a(()=>[e(m,null,{default:a(()=>[e(V,{class:"my-0 white--text mr-3 btn-login",style:{padding:"0 15px !important"},loading:n.value,disabled:n.value,onClick:y},{default:a(()=>[e(b,{size:"20",icon:"mdi:mdi-login"}),g("  Đăng nhập ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])),d.value?(x(),k("div",te,[ae,e(p,{align:"center",style:{margin:"20px 0","text-align":"center"}},{default:a(()=>[e(m,{cols:"12"},{default:a(()=>[e(V,{small:"",class:"my-0 white--text mr-3 btn-login",style:{padding:"0 15px !important"},loading:n.value,disabled:n.value,onClick:w},{default:a(()=>[e(b,{size:"20",icon:"mdi:mdi-home-circle-outline"}),g("  "),se]),_:1},8,["loading","disabled"]),e(V,{class:"my-0 white--text mr-3 mt-3 btn-login",small:"",style:{padding:"0 15px !important"},loading:n.value,disabled:n.value,onClick:I},{default:a(()=>[o("div",ne,[e(b,{size:"18",icon:"mdi:mdi-logout-variant"}),g("  "),oe])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})])):z("",!0)])]),_:1}),o("div",le,[e(A,{value:P.value},{default:a(()=>[e(D,{indeterminate:"",size:"64"})]),_:1},8,["value"])])]))}};export{me as default};
